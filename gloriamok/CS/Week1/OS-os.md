# os-os

# 운영체제(Operating System)란?

- 컴퓨터 하드웨어 바로 위에 설치되어 사용자 및 다른 모든 소프트웨어와 하드웨어를 연결하는 스프트웨어 계층
- 사용자가 컴퓨터를 편리하고 효과적으로 사용할 수 있도록 환경을 제공하는 시스템 소프트웨어

![출처: [운영체제 - 위키백과, 우리 모두의 백과사전 (wikipedia.org)](https://ko.wikipedia.org/wiki/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C)](https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Operating_system_placement_kor.svg/270px-Operating_system_placement_kor.svg.png)

출처: [운영체제 - 위키백과, 우리 모두의 백과사전 (wikipedia.org)](https://ko.wikipedia.org/wiki/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C)




## 운영체제의 역할

주요 역할 4가지

- **자원 관리:** CPU, 메모리와 같은 한정적인 시스템 자원을 효율적으로 관리
    - 실행중인 프로그램들에게 **CPU**를 번갈아 할당
    - 실행중인 프로그램들에 **메모리 공간**을 적절히 분배
- **프로세스 관리**: 프로세스의 생성, 스케줄링, 종료를 관리하며, 프로세스 간의 동기화와 통신을 제공
- **파일 시스템 관리**: 데이터의 저장, 검색, 수정 및 삭제를 위한 파일 관리와 디렉터리 구조를 제공
- **사용자 인터페이스 제공**: 사용자와 시스템 간의 상호작용을 가능하게 하는 인터페이스(명령줄, 그래픽 사용자 인터페이스)를 제공

## 운영체제의 구조/주요 구성요소

[출처: [[Operating System] 운영체제의 구조 :: wonseok.log (tistory.com)](https://math-coding.tistory.com/80)](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/S3U2H/btqHxbOhB2V/WeQANBQKfm6F58xkWsJZy0/img.png)

출처: [[Operating System] 운영체제의 구조 :: wonseok.log (tistory.com)](https://math-coding.tistory.com/80)

![출처: [Operating Systems: Structures (uic.edu)](https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/2_Structures.html)](https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter2/2_01_OS_Services.jpg)

출처: [Operating Systems: Structures (uic.edu)](https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/2_Structures.html)

- **커널(Kernel)**
    - 운영체제의 핵심 부분으로, 하드웨어와 소프트웨어 간의 인터페이스 역할을 수행
    - 운영체제가 응용 프로그램에 제공하는 서비스 중 핵심 서비스는 **자원에 접근하고 조작하는 기능, 프로그램이 올바르고 안전하게 실행되게 하는 기능**
        - 이 핵심 서비스를 담당하는 부분이 커널
    - 커널의 종류에 따라 프로그램이 하드웨어를 이용하는 양상과 컴퓨터 전체의 성능이 달라질 수 있음
    - **커널의 역할**
        1. **자원 관리**: 커널은 CPU, 메모리, I/O 장치와 같은 시스템 자원을 관리하며, 이러한 자원들을 프로세스에 할당하고 회수합니다.
        2. **프로세스 관리**: 프로세스의 생성, 스케줄링, 종료를 담당하며, 프로세스 간의 동기화와 통신을 지원합니다.
        3. **메모리 관리**: 물리 메모리와 가상 메모리를 관리하며, 메모리 보호, 할당 및 회수를 담당합니다.
        4. **장치 드라이버 인터페이스**: 하드웨어 장치와의 통신을 위한 인터페이스를 제공하며, 장치 드라이버를 통해 다양한 하드웨어 장치를 관리합니다.
        5. **시스템 호출 인터페이스**: 사용자 레벨의 프로그램이 운영체제의 서비스를 요청할 수 있도록 시스템 호출 API를 제공합니다.
- **시스템 호출 (System Call)**
    - 응용 프로그램과 커널의 인터페이스로, 커널이 자신을 보호하기 위해 만든 인터페이스이다. 커널은 사용자나 응용 프로그램으로부터 컴퓨터 자원을 보호하기 위해 자원에 직접 접근하는 것을 차단한다.
    - **사용자 모드로 실행되는 프로그램**이 자원에 접근하는 운영체제 서비스를 제공받기 위한 요청
        - 시스템 호출을 통해 **커널 모드로 전환**하여 운영체제 서비스를 제공받을 수 있음

![출처: [[운영체제란?] 커널의 개념, 이중 모드와 시스템 호출 (hanbit.co.kr)](https://hongong.hanbit.co.kr/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EB%9E%80-%EC%BB%A4%EB%84%90%EC%9D%98-%EA%B0%9C%EB%85%90-%EC%9D%91%EC%9A%A9-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%8B%A4%ED%96%89%EC%9D%84-%EC%9C%84%ED%95%9C/)](https://hongong.hanbit.co.kr/wp-content/uploads/2022/09/운영체제-커널모드-사용자모드-2.png)

출처: [[운영체제란?] 커널의 개념, 이중 모드와 시스템 호출 (hanbit.co.kr)](https://hongong.hanbit.co.kr/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EB%9E%80-%EC%BB%A4%EB%84%90%EC%9D%98-%EA%B0%9C%EB%85%90-%EC%9D%91%EC%9A%A9-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%8B%A4%ED%96%89%EC%9D%84-%EC%9C%84%ED%95%9C/)

- **드라이버 (driver)**
    - 커널과 하드웨어의 인터페이스
- **유저 인터페이스**
    - 커널에 사용자의 명령을 전달하고 실행 결과를 사용자에게 알려주는 역할
    - 그래픽 유저 인터페이스 (GUI): 그래픽을 기반으로 컴퓨터와 상호작용하는 인터페이스
    - 커맨드 라인 인터페이스 (CLI): 명령어를 기반으로 컴퓨터와 상호작용하는 인터페이스

### 운영체제의 이중 모드 (dual mode)

- CPU가 명령어를 실행하는 모드를 구분하는 방식
- **사용자 모드 (user mode)**
    - 운영체제 서비스를 제공받을 수 없는 실행 모드
    - 커널 영역의 코드를 실행할 수 없는 모드
    - 자원에 접근할 수 없음
    - 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행됨
- **커널 모드 (kernel mode = system mode)**
    - 운영체제 서비스를 제공받을 수 있는 실행 모드
    - 커널 영역의 코드를 실행할 수 있는 모드
    - 자원에 접근할 수 있음

### 시스템 콜 예시

시스템 콜(system call)은 사용자 모드에서 실행되는 프로그램이 운영체제의 커널에 서비스를 요청할 때 사용하는 인터페이스입니다. 시스템 콜을 통해 프로그램은 파일 조작, 네트워크 통신, 프로세스 관리 등의 커널 수준의 작업을 요청할 수 있습니다.

다음은 일반적인 시스템 콜의 예시입니다:

1. **파일 관련 시스템 콜**:
    - `open()`: 파일을 열거나 생성합니다.
    - `read()`: 파일에서 데이터를 읽습니다.
    - `write()`: 파일에 데이터를 씁니다.
    - `close()`: 파일을 닫습니다.
    - `lseek()`: 파일 내의 특정 위치로 포인터를 이동합니다.
2. **프로세스 관련 시스템 콜**:
    - `fork()`: 새로운 프로세스를 생성합니다.
    - `exec()`: 프로세스에서 새로운 프로그램을 실행합니다.
    - `wait()`: 자식 프로세스의 종료를 기다립니다.
    - `exit()`: 프로세스를 종료합니다.
3. **메모리 관련 시스템 콜**:
    - `mmap()`: 메모리에 파일이나 장치를 매핑합니다.
    - `munmap()`: 메모리 매핑을 해제합니다.
    - `brk()`: 데이터 세그먼트의 크기를 변경합니다.
4. **네트워크 관련 시스템 콜**:
    - `socket()`: 소켓을 생성합니다.
    - `bind()`: 소켓에 주소를 연결합니다.
    - `listen()`: 소켓에서 연결 요청을 기다립니다.
    - `accept()`: 연결 요청을 수락합니다.
    - `send()`, `recv()`: 데이터를 송수신합니다.
5. **기타 시스템 콜**:
    - `ioctl()`: 장치 드라이버에 다양한 명령을 전달합니다.
    - `getpid()`: 현재 프로세스의 ID를 반환합니다.
    - `sleep()`: 프로세스를 일정 시간 동안 잠재웁니다.

이러한 시스템 콜들은 프로그램이 운영체제의 핵심 기능에 접근하고 이를 활용할 수 있게 해줍니다.

### 시스템 콜 처리 순서

시스템 콜(system call)은 사용자 모드에서 실행되는 프로그램이 커널 모드의 서비스를 요청할 때 사용하는 인터페이스입니다. 예를 들어, 파일을 열거나 네트워크 통신을 수행하려면 해당 작업을 수행하기 위한 시스템 콜을 사용해야 합니다.

CPU가 시스템 콜을 처리하는 기본적인 순서는 다음과 같습니다:

1. **시스템 콜 요청**:
    - 사용자 프로그램은 특정 서비스를 요청하기 위해 시스템 콜을 호출합니다.
2. **사용자 모드에서 커널 모드로 전환**:
    - 시스템 콜은 커널 모드에서 실행되므로, CPU는 사용자 모드에서 커널 모드로 전환합니다. 이 전환은 특별한 명령어를 통해 수행됩니다.
3. **시스템 콜 번호 및 인자 확인**:
    - 각 시스템 콜은 고유한 번호를 가지고 있습니다. CPU는 이 번호를 확인하여 어떤 시스템 콜이 요청되었는지 파악합니다.
    - 또한, 시스템 콜에 전달된 인자도 확인하여 해당 서비스를 수행하기 위한 정보를 얻습니다.
4. **시스템 콜 처리**:
    - 커널은 시스템 콜 번호와 인자를 기반으로 해당 서비스를 수행합니다. 예를 들어, 파일 열기 시스템 콜이 요청되면, 커널은 해당 파일을 열고 파일 디스크립터를 반환합니다.
5. **결과 반환**:
    - 시스템 콜의 처리가 완료되면, 결과를 사용자 프로그램에 반환합니다. 이 결과는 성공, 실패, 또는 특정 값을 포함할 수 있습니다.
6. **커널 모드에서 사용자 모드로 전환**:
    - 시스템 콜 처리가 완료된 후, CPU는 커널 모드에서 사용자 모드로 다시 전환하고, 사용자 프로그램의 다음 명령어를 실행합니다.

이러한 과정을 통해 사용자 프로그램은 운영체제의 서비스를 안전하게 이용할 수 있습니다. 시스템 콜을 사용하면 사용자 프로그램은 직접 하드웨어 자원에 접근하는 대신, 운영체제를 통해 필요한 서비스를 요청하고 결과를 받아올 수 있습니다.